{
    "name": "üß† Qualifizer Router v2 (Multi-Search)",
    "nodes": [
        {
            "parameters": {
                "updates": [
                    "message"
                ]
            },
            "id": "telegram-trigger",
            "name": "üì± Telegram Trigger",
            "type": "n8n-nodes-base.telegramTrigger",
            "typeVersion": 1.1,
            "position": [
                0,
                300
            ],
            "webhookId": "telegram-qualifizer",
            "credentials": {
                "telegramApi": {
                    "id": "YOUR_TELEGRAM_CREDENTIALS_ID",
                    "name": "Telegram Bot"
                }
            }
        },
        {
            "parameters": {
                "promptType": "define",
                "text": "–¢—ã ‚Äî –≥–ª–∞–≤–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä AI-–∞–≥–µ–Ω—Ç–æ–≤ (Qualifizer). –¢–≤–æ—è —Ü–µ–ª—å ‚Äî –ø–æ–Ω—è—Ç—å –Ω–∞–º–µ—Ä–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –≤—ã–±—Ä–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç.\n\n–î–æ—Å—Ç—É–ø–Ω—ã–µ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—ã:\n1. RESEARCH ‚Äî –ü–æ–∏—Å–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –∞–Ω–∞–ª–∏–∑ —Ä—ã–Ω–∫–∞, –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è\n2. CONTENT ‚Äî –ù–∞–ø–∏—Å–∞–Ω–∏–µ –ø–æ—Å—Ç–æ–≤, —Å—Ç–∞—Ç–µ–π, –∫–æ–ø–∏—Ä–∞–π—Ç–∏–Ω–≥\n3. CODE ‚Äî –ù–∞–ø–∏—Å–∞–Ω–∏–µ –∫–æ–¥–∞, –æ—Ç–ª–∞–¥–∫–∞, —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–º–æ—â—å\n4. GENERAL ‚Äî –û–±—ã—á–Ω—ã–π —Ä–∞–∑–≥–æ–≤–æ—Ä, –≤–æ–ø—Ä–æ—Å—ã\n\n–û—Ç–≤–µ—Ç—å –¢–û–õ–¨–ö–û JSON-–æ–±—ä–µ–∫—Ç–æ–º (–±–µ–∑ markdown):\n{\n  \"intent\": \"RESEARCH\" | \"CONTENT\" | \"CODE\" | \"GENERAL\",\n  \"reason\": \"–ø–æ—á–µ–º—É —Ç—ã —Ç–∞–∫ —Ä–µ—à–∏–ª\",\n  \"search_query\": \"–ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –µ—Å–ª–∏ –Ω—É–∂–µ–Ω –ø–æ–∏—Å–∫, –∏–Ω–∞—á–µ null\",\n  \"task\": \"–æ—á–∏—â–µ–Ω–Ω–∞—è —Å—É—Ç—å –∑–∞–¥–∞—á–∏\"\n}\n\n–°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: {{ $json.message.text }}",
                "options": {
                    "temperature": 0
                }
            },
            "id": "intent-router",
            "name": "üéØ Intent Router",
            "type": "@n8n/n8n-nodes-langchain.chainLlm",
            "typeVersion": 1.4,
            "position": [
                220,
                300
            ]
        },
        {
            "parameters": {
                "modelName": "models/gemini-2.0-flash",
                "options": {
                    "temperature": 0
                }
            },
            "id": "gemini-router",
            "name": "Gemini Flash",
            "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
            "typeVersion": 1,
            "position": [
                220,
                520
            ],
            "credentials": {
                "googlePalmApi": {
                    "id": "YOUR_GEMINI_CREDENTIALS_ID",
                    "name": "Google Gemini API"
                }
            }
        },
        {
            "parameters": {
                "jsCode": "// Parse LLM response to JSON\nconst text = $input.first().json.text || $input.first().json.response;\n\n// Extract JSON from response\nlet jsonStr = text;\nif (text.includes('{')) {\n  jsonStr = text.substring(text.indexOf('{'), text.lastIndexOf('}') + 1);\n}\n\ntry {\n  const parsed = JSON.parse(jsonStr);\n  return [{ json: parsed }];\n} catch (e) {\n  return [{ json: { intent: 'GENERAL', reason: 'Parse error', search_query: null, task: text } }];\n}"
            },
            "id": "json-parser",
            "name": "üìã Parse JSON",
            "type": "n8n-nodes-base.code",
            "typeVersion": 2,
            "position": [
                440,
                300
            ]
        },
        {
            "parameters": {
                "dataType": "string",
                "value1": "={{ $json.intent }}",
                "rules": {
                    "rules": [
                        {
                            "value2": "RESEARCH",
                            "output": 0
                        },
                        {
                            "value2": "CONTENT",
                            "output": 1
                        },
                        {
                            "value2": "CODE",
                            "output": 2
                        }
                    ]
                },
                "fallbackOutput": "extra"
            },
            "id": "switch-department",
            "name": "üîÄ Switch Department",
            "type": "n8n-nodes-base.switch",
            "typeVersion": 3,
            "position": [
                660,
                300
            ]
        },
        {
            "parameters": {
                "method": "POST",
                "url": "https://api.tavily.com/search",
                "sendBody": true,
                "specifyBody": "json",
                "jsonBody": "={\n  \"api_key\": \"YOUR_TAVILY_API_KEY\",\n  \"query\": \"{{ $json.search_query || $json.task }}\",\n  \"search_depth\": \"advanced\",\n  \"include_answer\": true,\n  \"max_results\": 5\n}",
                "options": {}
            },
            "id": "tavily-search",
            "name": "üîç Tavily Search",
            "type": "n8n-nodes-base.httpRequest",
            "typeVersion": 4.2,
            "position": [
                900,
                100
            ]
        },
        {
            "parameters": {
                "method": "GET",
                "url": "http://searxng:8080/search",
                "sendQuery": true,
                "queryParameters": {
                    "parameters": [
                        {
                            "name": "q",
                            "value": "={{ $json.search_query || $json.task }}"
                        },
                        {
                            "name": "format",
                            "value": "json"
                        },
                        {
                            "name": "language",
                            "value": "ru"
                        }
                    ]
                },
                "options": {}
            },
            "id": "searxng-search",
            "name": "üîç SearxNG (Backup)",
            "type": "n8n-nodes-base.httpRequest",
            "typeVersion": 4.2,
            "position": [
                900,
                260
            ]
        },
        {
            "parameters": {
                "promptType": "define",
                "text": "–¢—ã ‚Äî –∫–æ–Ω—Ç–µ–Ω—Ç-–º–µ–Ω–µ–¥–∂–µ—Ä. –ù–∞–ø–∏—à–∏ –ø–æ—Å—Ç –¥–ª—è —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π –Ω–∞ —Ç–µ–º—É:\n\n{{ $json.task }}\n\n–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:\n- –ó–∞—Ö–≤–∞—Ç—ã–≤–∞—é—â–∏–π –∑–∞–≥–æ–ª–æ–≤–æ–∫\n- 3-5 –∞–±–∑–∞—Ü–µ–≤\n- –≠–º–æ–¥–∑–∏ –¥–ª—è –∞–∫—Ü–µ–Ω—Ç–æ–≤\n- Call-to-action –≤ –∫–æ–Ω—Ü–µ\n\n–û—Ç–≤–µ—Ç—å –≥–æ—Ç–æ–≤—ã–º –ø–æ—Å—Ç–æ–º.",
                "options": {}
            },
            "id": "content-agent",
            "name": "‚úçÔ∏è Content Agent",
            "type": "@n8n/n8n-nodes-langchain.chainLlm",
            "typeVersion": 1.4,
            "position": [
                900,
                420
            ]
        },
        {
            "parameters": {
                "promptType": "define",
                "text": "–¢—ã ‚Äî Senior Developer. –ü–æ–º–æ–≥–∏ —Å –∑–∞–¥–∞—á–µ–π:\n\n{{ $json.task }}\n\n–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:\n- –ü–∏—à–∏ —á–∏—Å—Ç—ã–π, —á–∏—Ç–∞–µ–º—ã–π –∫–æ–¥\n- –î–æ–±–∞–≤—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏\n- –ò—Å–ø–æ–ª—å–∑—É–π best practices\n\n–û—Ç–≤–µ—Ç—å –∫–æ–¥–æ–º —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º.",
                "options": {}
            },
            "id": "code-agent",
            "name": "üíª Code Agent",
            "type": "@n8n/n8n-nodes-langchain.chainLlm",
            "typeVersion": 1.4,
            "position": [
                900,
                580
            ]
        },
        {
            "parameters": {
                "chatId": "={{ $('üì± Telegram Trigger').item.json.message.chat.id }}",
                "text": "=ü§ñ **Qualifizer Response**\n\n{{ $json.text || $json.answer || $json.response || JSON.stringify($json) }}"
            },
            "id": "telegram-reply",
            "name": "üì§ Send Reply",
            "type": "n8n-nodes-base.telegram",
            "typeVersion": 1.2,
            "position": [
                1200,
                300
            ],
            "credentials": {
                "telegramApi": {
                    "id": "YOUR_TELEGRAM_CREDENTIALS_ID",
                    "name": "Telegram Bot"
                }
            }
        },
        {
            "parameters": {
                "modelName": "models/gemini-2.0-flash",
                "options": {}
            },
            "id": "gemini-content",
            "name": "Gemini (Content)",
            "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
            "typeVersion": 1,
            "position": [
                900,
                620
            ],
            "credentials": {
                "googlePalmApi": {
                    "id": "YOUR_GEMINI_CREDENTIALS_ID",
                    "name": "Google Gemini API"
                }
            }
        },
        {
            "parameters": {
                "modelName": "models/gemini-2.0-flash",
                "options": {}
            },
            "id": "gemini-code",
            "name": "Gemini (Code)",
            "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
            "typeVersion": 1,
            "position": [
                900,
                780
            ],
            "credentials": {
                "googlePalmApi": {
                    "id": "YOUR_GEMINI_CREDENTIALS_ID",
                    "name": "Google Gemini API"
                }
            }
        }
    ],
    "connections": {
        "üì± Telegram Trigger": {
            "main": [
                [
                    {
                        "node": "üéØ Intent Router",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Gemini Flash": {
            "ai_languageModel": [
                [
                    {
                        "node": "üéØ Intent Router",
                        "type": "ai_languageModel",
                        "index": 0
                    }
                ]
            ]
        },
        "üéØ Intent Router": {
            "main": [
                [
                    {
                        "node": "üìã Parse JSON",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "üìã Parse JSON": {
            "main": [
                [
                    {
                        "node": "üîÄ Switch Department",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "üîÄ Switch Department": {
            "main": [
                [
                    {
                        "node": "üîç Tavily Search",
                        "type": "main",
                        "index": 0
                    }
                ],
                [
                    {
                        "node": "‚úçÔ∏è Content Agent",
                        "type": "main",
                        "index": 0
                    }
                ],
                [
                    {
                        "node": "üíª Code Agent",
                        "type": "main",
                        "index": 0
                    }
                ],
                [
                    {
                        "node": "üì§ Send Reply",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "üîç Tavily Search": {
            "main": [
                [
                    {
                        "node": "üì§ Send Reply",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "üîç SearxNG (Backup)": {
            "main": [
                [
                    {
                        "node": "üì§ Send Reply",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "‚úçÔ∏è Content Agent": {
            "main": [
                [
                    {
                        "node": "üì§ Send Reply",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "üíª Code Agent": {
            "main": [
                [
                    {
                        "node": "üì§ Send Reply",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Gemini (Content)": {
            "ai_languageModel": [
                [
                    {
                        "node": "‚úçÔ∏è Content Agent",
                        "type": "ai_languageModel",
                        "index": 0
                    }
                ]
            ]
        },
        "Gemini (Code)": {
            "ai_languageModel": [
                [
                    {
                        "node": "üíª Code Agent",
                        "type": "ai_languageModel",
                        "index": 0
                    }
                ]
            ]
        }
    },
    "pinData": {},
    "settings": {
        "executionOrder": "v1"
    }
}